# 农业大数据平台Kafka和WebSocket配置
# 支持环境配置:
# 1. 可通过环境变量 ACTIVE_PROFILE 指定激活环境: dev, test, prod
# 2. 可通过环境变量 CONFIG_PATH 指定外部配置文件路径
# 3. 环境特定配置将覆盖默认配置

# 主机配置 - 集中管理服务器地址，方便修改
hosts {
  # Spark主机地址
  spark = "shiguang"
  # Kafka主机地址（更新为集群地址）
  kafka = "shiguang:9092,nas:9092"
  # MySQL主机地址
  mysql = "shiguang"
}

# Spark配置
spark {
  master = "spark://192.168.1.192:7077"  # 使用IP地址替代主机名
  "batch-interval" = 5   # 批处理间隔（秒）
  "app-name" = "AgricultureSensorProcessor"
  streaming {
    "batch-duration" = 5
  }
  kryo {
    enabled = true
    "buffer-max-mb" = 64
  }
  ui {
    port = 4040
    enabled = true
  }
}

# Kafka配置
kafka {
  "bootstrap-servers" = "shiguang:9092,nas:9092"
  topic = "agriculture_sensors"
  "group-id" = "agriculture_sensor_group"
}

# WebSocket配置
websocket {
  host = "0.0.0.0"  # 允许所有网络接口接入
  port = 8085    # 修改为另一个端口
  path = "/"
}

# 数据库配置
database {
  driver = "com.mysql.cj.jdbc.Driver"
  url = "jdbc:mysql://"${hosts.mysql}":3306/agri_big_data?useSSL=false&serverTimezone=Asia/Shanghai"
  user = "root"
  password = "082415"
}

# 异常阈值配置
threshold {
  temperature {
    max = 40.0
    min = 0.0
  }
  humidity {
    max = 100.0
    min = 0.0
  }
  "soil-moisture" {
    max = 100.0
    min = 0.0
  }
  "light-intensity" {
    max = 1000.0
    min = 0.0
  }
  co2 {
    max = 2000.0
    min = 200.0
  }
  battery {
    min = 10.0  # 电池电量低于10%告警
  }
}

# 日志配置
logging {
  level {
    root = "WARN"
    "org.shiguang" = "INFO"
    "org.apache.spark" = "WARN"
    "org.apache.kafka" = "WARN"
  }
}

# 环境特定配置 - 可根据 ACTIVE_PROFILE 环境变量加载不同环境配置
# 开发环境配置